import{r as u,m as B,k as D,j as e}from"./vendor.react-rN-pUNOy.js";import{a as V,c as R}from"./index-I9wQ1uQd.js";import{F as n,T as v,k as A,j,I as W,B as d,b as g,D as L,s as t}from"./vendor.antd-csk3Ol5G.js";import{bD as q,bF as G,bG as H}from"./vendor.other-DSSnOnwO.js";import"./vendor.redux-Ck2zd-1P.js";const{Title:K}=v,{TextArea:M}=W,{Option:p}=j;function _(){const[l]=n.useForm(),[X]=n.useForm(),[i,C]=u.useState("students"),[o,S]=u.useState("students"),[c,h]=u.useState(""),y=B(),T=D(r=>r.students.list),b=D(r=>r.teachers.list),w=async()=>{try{const m=(await l.validateFields()).jsonData;let s;try{s=JSON.parse(m)}catch{t.error("JSON格式不正确，请检查输入内容");return}if(!Array.isArray(s)){t.error("导入的数据必须是数组格式");return}if(s.length===0){t.warning("没有数据需要导入");return}if(i==="students"){if(!s.every(a=>a.name&&a.gender&&a.age!==void 0&&a.dailyClasses!==void 0&&a.classDuration!==void 0)){t.error("学生数据格式不正确，必须包含name、gender、age、dailyClasses和classDuration字段");return}s.forEach((a,x)=>{y(V({...a,id:a.id||Date.now()+x}))}),t.success(`成功导入 ${s.length} 名学生数据`)}else if(i==="teachers"){if(!s.every(a=>a.name&&a.gender)){t.error("教师数据格式不正确，必须包含name和gender字段");return}s.forEach((a,x)=>{y(R({...a,id:a.id||Date.now()+x}))}),t.success(`成功导入 ${s.length} 名教师数据`)}l.resetFields(["jsonData"])}catch{t.error("导入失败，请重试")}},F=()=>JSON.stringify(i==="students"?[{id:1,name:"张三",gender:"male",age:8,dailyClasses:1,classDuration:60},{id:2,name:"李四",gender:"female",age:7,dailyClasses:2,classDuration:90}]:[{id:1,name:"王老师",gender:"female"},{id:2,name:"李老师",gender:"male"}],null,2),I=()=>{l.setFieldsValue({jsonData:F()})},k=r=>{C(r),l.resetFields(["jsonData"])},E=r=>{S(r),h("")},O=async()=>{try{let r=[];if(o==="students"?r=T.map(s=>({id:s.id,name:s.name,gender:s.gender,age:s.age,dailyClasses:s.dailyClasses,classDuration:s.classDuration})):o==="teachers"&&(r=b.map(s=>({id:s.id,name:s.name,gender:s.gender}))),r.length===0){t.warning(`暂无${o==="students"?"学生":"教师"}数据可导出`),h("");return}const m=JSON.stringify(r,null,2);await navigator.clipboard.writeText(m),h(m),t.success(`成功导出 ${r.length} 条${o==="students"?"学生":"教师"}数据到剪贴板`)}catch(r){t.error("导出失败，请重试"),console.error("Export error:",r)}},J=()=>{l.resetFields(["jsonData"])},N=async()=>{if(c)try{await navigator.clipboard.writeText(c),t.success("数据已复制到剪贴板")}catch{t.error("复制失败，请手动复制")}},$=()=>e.jsxs(n,{form:l,layout:"vertical",style:{maxWidth:800},children:[e.jsx(n.Item,{name:"importType",label:"导入类型",rules:[{required:!0}],initialValue:"students",children:e.jsxs(j,{onChange:k,children:[e.jsx(p,{value:"students",children:"学生数据"}),e.jsx(p,{value:"teachers",children:"教师数据"})]})}),e.jsx(n.Item,{name:"jsonData",label:`${i==="students"?"学生":"教师"}数据(JSON格式)`,rules:[{required:!0,message:"请输入JSON格式的数据"}],children:e.jsx(M,{rows:12,placeholder:`请粘贴${i==="students"?"学生":"教师"}数据的JSON格式内容`,style:{fontFamily:"monospace",fontSize:"14px"}})}),e.jsx(n.Item,{children:e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.jsx(d,{type:"primary",icon:e.jsx(q,{}),onClick:w,children:"导入数据"}),e.jsx(d,{onClick:I,children:"加载示例数据"}),e.jsx(d,{onClick:J,danger:!0,children:"清空输入"})]})}),e.jsx(g,{size:"small",title:"数据格式说明",style:{marginTop:20},children:e.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[i==="students"?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"学生数据必须包含：name（姓名）、gender（性别）、age（年龄）、dailyClasses（每天上课次数）、classDuration（上课时长）"}),e.jsx("li",{children:"gender取值为：male（男）或female（女）"}),e.jsx("li",{children:"dailyClasses取值为：1或2"}),e.jsx("li",{children:"classDuration取值为：30, 60, 90, 120等分钟数"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"教师数据必须包含：name（姓名）、gender（性别）"}),e.jsx("li",{children:"gender取值为：male（男）或female（女）"})]}),e.jsx("li",{children:"数据必须是JSON数组格式"})]})})]}),z=()=>e.jsxs("div",{style:{maxWidth:800},children:[e.jsx(n.Item,{label:"导出类型",style:{marginBottom:24},children:e.jsxs(j,{value:o,onChange:E,style:{width:200},children:[e.jsx(p,{value:"students",children:"学生数据"}),e.jsx(p,{value:"teachers",children:"教师数据"})]})}),e.jsx(d,{type:"primary",icon:e.jsx(G,{}),onClick:O,style:{marginBottom:16},children:"生成导出数据"}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs(v.Text,{strong:!0,children:[o==="students"?"学生":"教师","数据预览"]}),e.jsx(d,{size:"small",onClick:N,icon:e.jsx(H,{}),children:"复制到剪贴板"})]}),e.jsx(g,{size:"small",bordered:!1,children:e.jsx("pre",{style:{backgroundColor:"#f5f5f5",padding:"16px",borderRadius:"4px",overflowX:"auto",margin:0,fontFamily:"monospace",fontSize:"13px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:c})})]}),e.jsx(L,{style:{margin:"20px 0"}}),e.jsx(g,{size:"small",title:"导出说明",style:{marginTop:8},children:e.jsxs("ul",{style:{margin:0,paddingLeft:20},children:[e.jsx("li",{children:'点击"生成导出数据"按钮生成当前系统中的数据'}),e.jsx("li",{children:"数据将自动复制到剪贴板，并在下方预览区域显示"}),e.jsx("li",{children:'您可以点击"复制到剪贴板"按钮再次复制数据'}),e.jsx("li",{children:"导出的数据格式与导入所需格式一致，确保兼容性"})]})})]});return e.jsxs("div",{children:[e.jsx(K,{level:2,children:"数据管理"}),e.jsx(A,{defaultActiveKey:"import",items:[{key:"import",label:"数据导入",children:$()},{key:"export",label:"数据导出",children:z()}],style:{maxWidth:800}})]})}export{_ as default};
